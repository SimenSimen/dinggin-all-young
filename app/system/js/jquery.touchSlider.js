(function(e){e.fn.reverse=[].reverse;e.fn.touchSlider=function(t){var t=e.extend({item:"div.item",holder:"div.holder",box:"div.list",debug:false,mode:"shift",shift:"80%",delta:40,single:false,center:false,animation:"auto",touch:true,duration:500,prevLink:null,nextLink:null,onChange:null,onStart:null,onCheckItems:null,lockScroll:false,hideClass:"mt-hidden",activeClass:"active"},t);this.each(function(){function S(){setTimeout(C,200)}function C(n){N=o.width();w=0;var n=typeof n=="undefined"?false:n;if(n&&e.isFunction(t.onStart)){t.onStart()}switch(t.mode){case"index":if(t.single){var r=0;if(n){A()}else{e(s[p]).css("width",N);setTimeout(M,100)}j()}else if(t.center){j()}break;case"shift":R();break;case"auto":m=[];if(t.single)k();q("both");s.each(function(e,t){var n=this.offsetWidth;var r=m.length;if(e==0){if(n>N){m.push([n,new Array(new Array(e,n)),0])}else{m.push([n,new Array(new Array(e,n))])}L(e)}else{if(m[r-1][0]+n<=N){m[r-1][0]+=n;m[r-1][1].push(new Array(e,n));L(e)}else{if(n>N){m.push([n,new Array(new Array(e,n)),0])}else{m.push([n,new Array(new Array(e,n))])}L(e)}}});if(p>=m.length)X(m.length-1);if(t.single)O();if(e.isFunction(t.onCheckItems))t.onCheckItems();F();break}}function k(){e(s).css("width","")}function L(e){if(e==v){X(m.length-1)}}function A(){e.each(s,function(){e(this).css("width","");var t=e(this).width();if(t<N){e(this).css("width",N)}})}function O(){e.each(m,function(t,n){if(n[0]<N){var r=n[0];n[0]=N;e(n[1]).each(function(t,n){n[1]=parseInt(N*n[1]/r);e(s[n[0]]).css("width",n[1])})}})}function M(){A();j(true)}function _(e){var t=i?e.originalEvent.touches[0]:e;switch(e.type){case r[i]["move"]:D(e,t);break;case r[i]["start"]:P(e,t);break;case r[i]["end"]:case r[i]["leave"]:H(e);break}}function D(e,n){if(x){if(t.lockScroll&&e.type!="click")e.preventDefault();w=T-n.pageX;if(w!=0){Z(d-w,true)}}}function P(e,t){if(!x){E=false;W("Touch Start");x=true;w=0;T=i?t.pageX:e.clientX}}function H(e,n){if(x){W("Touch End");x=false;T=0;if(w!=0){if(w>t.delta||w<0-t.delta){B()}else{Z(d)}}}w=0}function B(){switch(t.mode){case"shift":R();break;case"index":j();break;case"auto":F();break}}function j(n){var r=0;var i=0;e.each(s,function(e){if(e<p){i+=this.offsetWidth}r+=this.offsetWidth});if(r<=N){I("both");return}else{q("both")}var o=0;if(w>0){if(t.center){o=0-(i+e(s[p]).width()+e(s[p+1]).width()/2)+N/2;if(p<s.length-1){X(p+1);V(o);Z(d)}else{Z(d)}}else{o=0-(i+e(s[p]).width());if(r+o>N){X(p+1);V(o);Z(d)}else{X(s.length-1);V(0-(r-N));Z(d)}}}else if(w<0){if(t.center){o=0-(i-e(s[p-1]).width()/2)+N/2;if(p>0){X(p-1);V(o);Z(d)}else{Z(d)}}else{o=0-(i-e(s[p]).width());if(o<0){X(p-1);V(o);Z(d)}else{X(0);V(0);Z(d)}}}else{if(t.center){o=0-(i+e(s[p]).width()/2)+N/2;V(o);if(typeof n=="undefined"){Z(d)}else{Z(d,true)}}else{o=0-i;V(o);if(typeof n=="undefined"){Z(d)}else{Z(d,true)}}}}function F(){var n=0;var r=0;N=o.width();e.each(m,function(e){if(e<p){r+=this[0]}n+=this[0]});var i=m[p].length>2?true:false;if(n<=N){I("both")}else{q("both")}if(t.center&&n<N){s=N/2-n/2;V(s);Z(d);return}var s=0;if(w>0){if(p<m.length-1||p>=m.length-1&&i){if(i&&m[p][0]-N>m[p][2]){m[p][2]+=N;if(m[p][0]-m[p][2]>N){V(d-N);Z(d)}else{V(d-(m[p][0]-m[p][2]));m[p][2]+=m[p][0]-m[p][2];m[p][2]-=N;Z(d)}}else{if(typeof m[p+1]!="undefined"){if(m[p+1].length>2){s=0-(r+m[p][0])}else{s=0-(r+m[p][0]+m[p+1][0]/2)+N/2}if(n+s>N){X(p+1);V(s);Z(d)}else{X(m.length-1);V(0-(n-N));Z(d)}}else{Z(d)}}}else{Z(d)}}else if(w<0){if(p>0||p<=0&&i){if(i&&m[p][2]>0){m[p][2]-=N;if(m[p][2]>=0){V(d+N);Z(d)}else{V(d+(m[p][2]+N));m[p][2]=0;Z(d)}}else{if(typeof m[p-1]!="undefined"){if(m[p-1].length>2){s=0-(r-N);m[p-1][2]=m[p-1][0]-N}else{s=0-(r-m[p-1][0]/2)+N/2}if(s<0){X(p-1);V(s);Z(d)}else{X(0);V(0);Z(d)}}else{Z(d)}}}else{Z(d)}}else{if(i){s=0-r}else{s=0-(r+m[p][0]/2)+N/2}if(s>=0){V(0);Z(d)}else if(n+s<=N){V(0-(n-N));Z(d)}else{V(s);Z(d)}}}function I(r){switch(r){case"both":if(t.prevLink)e(t.prevLink,n).addClass(t.hideClass);if(t.nextLink)e(t.nextLink,n).addClass(t.hideClass);break;case"prev":if(t.prevLink)e(t.prevLink,n).addClass(t.hideClass);break;case"next":if(t.nextLink)e(t.nextLink,n).addClass(t.hideClass);break}N=o.width()}function q(r){switch(r){case"both":if(t.prevLink)e(t.prevLink,n).removeClass(t.hideClass);if(t.nextLink)e(t.nextLink,n).removeClass(t.hideClass);break;case"prev":if(t.prevLink)e(t.prevLink,n).removeClass(t.hideClass);break;case"next":if(t.nextLink)e(t.nextLink,n).removeClass(t.hideClass);break}N=o.width()}function R(){var n=0;e.each(s,function(){n+=this.offsetWidth});if(n<N&&!t.center){return}var r=t.shift+"";var i=0;if(r.indexOf("%")!=-1){r=parseInt(N*t.shift.substr(0,t.shift.length-1)/100)}else{r=parseInt(t.shift)}if(t.center&&n<N){i=N/2-n/2;V(i);Z(d)}else{if(w>0){i=d-r;if(n+i>N){V(i);Z(d)}else{V(0-(n-N));Z(d)}}else{i=d+r;if(i<0){V(i);Z(d)}else{V(0);Z(d)}}}}function U(){w=1;R()}function z(){w=-1;R()}function W(n,r){if(typeof r=="undefined"){r=""}if(t.debug){var i=new Date;e("#console").prepend('<div class="debug-item"><strong>'+i.getMinutes()+":"+i.getSeconds()+"."+i.getMilliseconds()+"</strong> "+n+" "+r+"</div>")}}function X(n){if(n!=p){E=true;y=p;p=n;if(t.mode=="auto"&&m.length){v=m[p][1][0][0]}else{e(s).removeClass(t.activeClass);e(s[p]).addClass(t.activeClass)}W("Setting up current index:",n)}else{E=true}}function V(e){e=parseInt(e,10);if(e!=d){b=d;d=e;W("Setting current offset:",e)}}function J(e){if(typeof s[e]!="undefined"){X(parseInt(e));w=0;j()}}function K(){w=1;j()}function Q(){w=-1;j()}function G(){w=1;F()}function Y(){w=-1;F()}function Z(n,r){var i=typeof r=="undefined"?t.duration:0;if(typeof r=="undefined"&&e.isFunction(t.onChange)&&E){t.onChange(y,p)}if(!t.animation){if(i){et();u.css({"margin-left":n+"px"});tt()}}else{et();var s=typeof r=="undefined"?t.duration/1e3+"s":"0";if(a){u.css({"-webkit-transition-duration":s,"-moz-transition-duration":s,"transition-duration":s});if(h){W("CSS 3D Transition To:",n);u.css({"-webkit-transform":"translate3d("+n+"px,0,0)",transform:"translate3d("+n+"px,0,0)"})}else{W("CSS Transition To:",n);u.css({"-webkit-transform":"translate("+n+"px,0)","-moz-transform":"translate("+n+"px,0)",transform:"translate("+n+"px,0)"})}}else{W("jQuery Animate To:",n);u.animate({"margin-left":n+"px"},{queue:false,duration:i,easing:"swing",complete:tt})}}}function et(){u.addClass("moving");W("Animation start","")}function tt(){u.removeClass("moving");W("Animation end","")}var n=jQuery(this);if(t.debug)e("body").append('<div id="console"></div>');var r=[{start:"mousedown",end:"mouseup",move:"mousemove",leave:"mouseout"},{start:"touchstart",end:"touchend",move:"touchmove",leave:"touchend"}];var i="ontouchend"in document?1:0;var s=e(t.item,this);if(!s.length)return;var o=e(t.holder,this).first();if(!o.length)return;var u=e(t.box,this).first();if(!u.length)return;var a=false;if(t.animation&&t.animation!="js"){var f=document.body||document.documentElement;var l=f.style;var c=l.WebkitTransition!==undefined?"webkitTransitionEnd":"transitionend";a=l.WebkitTransition!==undefined||l.MozTransition!==undefined||l.transition!==undefined;if(a&&t.animation=="auto"){W("Detected Transitions Support","");u.css({"-webkit-transition-property":"-webkit-transform","-webkit-transition-timing-function":"ease","-moz-transition-property":"-moz-transform","-moz-transition-timing-function":"ease","transition-property":"transform","transition-timing-function":"ease"});u.unbind(c);u.bind(c,tt)}var h="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix;if(h){W("Detected 3D Support","")}}var p=null;var d=null;var v=0;var m=[];var g=0;var y=null;var b=null;var w=0;var E=false;X(0);V(0);if(t.touch){u.bind(r[i]["start"],this,_);u.bind(r[i]["end"],this,_);u.bind(r[i]["leave"],this,_);u.bind(r[i]["move"],this,_)}if(t.prevLink){e(t.prevLink,n).bind("click",function(){n.get(0).movePrev();return false})}if(t.nextLink){e(t.nextLink,n).bind("click",function(){n.get(0).moveNext();return false})}e(window).bind("onorientationchange"in window?"orientationchange":"resize",this,S);e(window).bind("load",this,S);var x=false;var T=0;var N=o.width();W("Current width:",N);this.getCount=function(){return t.mode=="auto"?m.length:e(s).length};this.moveNext=function(){switch(t.mode){case"index":K();break;case"shift":U();break;case"auto":G();break}};this.movePrev=function(){switch(t.mode){case"index":Q();break;case"shift":z();break;case"auto":Y();break}};this.moveTo=function(e){switch(t.mode){case"index":J(e);break}};this.refresh=function(){C()};C(true);});return this}})(jQuery)